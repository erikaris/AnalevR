<html>

<head>
    <meta charset="utf-8">

    <title>Untitled</title>

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.35.0/codemirror.min.css">

    <link rel="stylesheet" href="https://cdn.jupyter.org/notebook/5.2.1/components/bootstrap-tour/build/css/bootstrap-tour.min.css?v=d0b3c2fce6056a2ddd5a4513762a94c4"
        type="text/css">
    <link rel="stylesheet" href="https://cdn.jupyter.org/notebook/5.2.1/components/codemirror/lib/codemirror.css?v=ae81317fa2b3a745892c83985827d41b">
    <link rel="stylesheet" href="https://cdn.jupyter.org/notebook/5.2.1/style/style.min.css?v=d87994e2e71f4741e4c4e3af747f9875"
        type="text/css">
    <link rel="stylesheet" href="https://cdn.jupyter.org/notebook/5.2.1/notebook/css/override.css?v=e6f18013b8771987812e992b38ec3318"
        type="text/css">

    <style>
        div.input {
            max-height: 150px;
        }
        .cell_toolbar {
            position: absolute;
            top: 0;
            right: 0;
            z-index: 1000;
        }
        .cell_toolbar .btn:first-child {
            border-bottom-left-radius: 5px;
        }
        .cell_toolbar  .btn:last-child {
            border-radius: 0 5px 0 0;
        }
        .cell_toolbar .btn {
            display: inline-block;
            border-color: #ababab;
            background-color: #fff;
            color: #ababab;
            font-size: 18px;
            border-radius: 0;
            border-width: 0 0 1px 1px;
        }
        .cell_toolbar .btn:hover .fa {
            color: #0000ff;
        }
        .cell_toolbar .btn:hover .fa-play {
            color: #008000;
        }
    </style>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.35.0/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.35.0/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.35.0/mode/r/r.min.js"></script>

    <script type="text/javascript">
        (function ($) {
            $.fn.codemirror = function (options) {
                var result = this;

                var settings = $.extend({
                    'mode': 'javascript',
                    'lineNumbers': false,
                    'runmode': false
                }, options);

                if (settings.runmode) this.each(function () {
                    var obj = $(this);
                    var accum = [],
                        gutter = [],
                        size = 0;
                    var callback = function (string, style) {
                        if (string == "\n") {
                            accum.push("<br>");
                            gutter.push('<pre>' + (++size) + '</pre>');
                        } else if (style) {
                            accum.push("<span class=\"cm-" + CodeMirror.htmlEscape(style) + "\">" +
                                CodeMirror.htmlEscape(string) + "</span>");
                        } else {
                            accum.push(CodeMirror.htmlEscape(string));
                        }
                    }
                    CodeMirror.runMode(obj.val(), settings.mode, callback);
                    $('<div class="CodeMirror">' + (settings.lineNumbers ? (
                            '<div class="CodeMirror-gutter"><div class="CodeMirror-gutter-text">' +
                            gutter.join('') + '</div></div>') : '<!--gutter-->') +
                        '<div class="CodeMirror-lines">' + (settings.lineNumbers ?
                            '<div style="position: relative; margin-left: ' + size.toString().length +
                            'em;">' : '<div>') + '<pre class="cm-s-default">' + accum.join('') +
                        '</pre></div></div></div>').insertAfter(obj);
                    obj.hide();
                });
                else this.each(function () {
                    result = CodeMirror.fromTextArea(this, settings);
                });

                return result;
            };
        })(jQuery);

        var waitingDialog = waitingDialog || (function ($) {
            'use strict';

            // Creating modal dialog's DOM
            var $dialog = $(
                '<div class="modal fade" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-hidden="true" style="padding-top:15%; overflow-y:visible;">' +
                '<div class="modal-dialog modal-m">' +
                '<div class="modal-content">' +
                    '<div class="modal-header"><h3 style="margin:0;"></h3></div>' +
                    '<div class="modal-body">' +
                        '<div class="progress progress-striped active" style="margin-bottom:0;"><div class="progress-bar" style="width: 100%"></div></div>' +
                    '</div>' +
                '</div></div></div>');

            return {
                /**
                 * Opens our dialog
                 * @param message Custom message
                 * @param options Custom options:
                 * 				  options.dialogSize - bootstrap postfix for dialog size, e.g. "sm", "m";
                 * 				  options.progressType - bootstrap postfix for progress bar type, e.g. "success", "warning".
                 */
                show: function (message, options) {
                    // Assigning defaults
                    if (typeof options === 'undefined') {
                        options = {};
                    }
                    if (typeof message === 'undefined') {
                        message = 'Loading';
                    }
                    var settings = $.extend({
                        dialogSize: 'm',
                        progressType: '',
                        onHide: null // This callback runs after the dialog was hidden
                    }, options);

                    // Configuring dialog
                    $dialog.find('.modal-dialog').attr('class', 'modal-dialog').addClass('modal-' + settings.dialogSize);
                    $dialog.find('.progress-bar').attr('class', 'progress-bar');
                    if (settings.progressType) {
                        $dialog.find('.progress-bar').addClass('progress-bar-' + settings.progressType);
                    }
                    $dialog.find('h3').text(message);
                    // Adding callbacks
                    if (typeof settings.onHide === 'function') {
                        $dialog.off('hidden.bs.modal').on('hidden.bs.modal', function (e) {
                            settings.onHide.call($dialog);
                        });
                    }
                    // Opening dialog
                    $dialog.modal();

                    return $dialog;
                },
                /**
                 * Closes dialog
                 */
                hide: function () {
                    $dialog.modal('hide');

                    return $dialog;
                }
            };

        })(jQuery);
    </script>
</head>

<body class="notebook_app command_mode" dir="ltr">


    <div id="header" style="display: block;">
        <div id="header-container" class="container">
            <div id="ipython_notebook" class="nav navbar-brand">
                <a href="/user/q30haM8usSHv/tree" title="dashboard">
                    <img src="https://cdn.jupyter.org/notebook/5.2.1/base/images/logo.png?v=641991992878ee24c6f3826e81054a0f" alt="Jupyter Notebook">
                </a>
            </div>


            <span id="save_widget" class="save_widget">
                <span id="notebook_name" class="filename">Untitled</span>
                <span class="checkpoint_status" title="Fri, Feb 23, 2018 6:38 AM">Last Checkpoint: 2 minutes ago</span>
                <span class="autosave_status">(unsaved changes)</span>
            </span>


        </div>

    </div>

    <div id="site" style="display: block;">
        <div id="ipython-main-app">
            <div id="notebook_panel">
                <div id="notebook" tabindex="-1">
                    <div class="container" id="notebook-container">
                        <div class="cell code_cell unrendered selected" tabindex="2">
                            <div class="input">
                                <div class="prompt input_prompt">
                                    <bdi>In</bdi>&nbsp;[&nbsp;]:
                                </div>
                                <div class="inner_cell">
                                    <div class="cell_toolbar">
                                        <a class="btn run"><i class="fa fa-play"></i></a>
                                        <a class="btn copy"><i class="fa fa-copy"></i></a>
                                        <a class="btn paste"><i class="fa fa-paste"></i></a>
                                    </div>
                                    <textarea class="input_area"></textarea>
                                </div>
                            </div>
                            <div class="output_wrapper">
                                <div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output"></div>
                                <div class="output"></div>
                                <div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .
                                </div>
                            </div>
                        </div>

                        <div class="cell">
                            <i class="fa fa-plus"></i>
                        </div>

                    </div>
                    <div class="end_space"></div>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        $(function () {
            $input = $('.input .input_area').codemirror({
                'mode': 'r',
                'lineNumbers': true,
                'indentUnit': 2,
                'tabSize': 2,
                'indentWithTabs': true,
                // 'lineWrapping': true,
            });

            $(document).ready(function() {
                $dialog = $('<div class="modal fade" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-hidden="true" style="padding-top:15%; overflow-y:visible;">' +
                    '<div class="modal-dialog modal-m">' +
                    '<div class="modal-content">' +
                        '<div class="modal-header"><h3 style="margin:0;">Staring workspace...</h3></div>' +
                        '<div class="modal-body">' +
                            '<div class="progress progress-striped active" style="margin-bottom:0;"><div class="progress-bar" style="width: 100%"></div></div>' +
                        '</div>' +
                    '</div></div></div>');

                $dialog.modal();

                $.post('{{ base_url }}/api/session/start/{{ session_id }}', {
                    'user_id': '{{ user_id }}'
                }, function(resp) {
                    if (resp.success) $dialog.modal('hide');
                });
            });

            $(document).on('click', '.input .run', function() {
                $.post('{{ base_url }}/api/session/eval/{{ session_id }}', {
                    'user_id': '{{ user_id }}',
                    'cmd': $input.getValue()
                }, function(resp) {
                    if (resp.success) $dialog.modal('hide');
                });
            });

            $(document).on('click', '.input .copy', function() {

            });

            $(document).on('click', '.input .paste', function() {

            });
        });
    </script>
</body>

</html>